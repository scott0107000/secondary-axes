!function(){let t={hanzi:"林",font:"",upm:1e3,baseline:150,facew:96,faceh:96,medw:40,medh:40,overshoot:!0,weightmix:.5,hweight:.2,vweight:.2};function e(){t.hanzi=$("#hanzi-input").val(),t.upm=parseFloat($("#upm-input").val()),t.baseline=parseFloat($("#baseline-input").val()),t.facew=parseFloat($("#facew-input").val()),t.faceh=parseFloat($("#faceh-input").val()),t.medw=parseFloat($("#medw-input").val()),t.medh=parseFloat($("#medh-input").val()),t.overshoot=$("#overshoot-input").is(":checked"),t.weightmix=parseFloat($("#weightmix-input").val()),t.hweight=parseFloat($("#hweight-input").val()),t.vweight=parseFloat($("#vweight-input").val());var a=$("#font-input").val();try{""===a||void 0===a?(t.font="",$("#glyph-box").css({fontFamily:""})):document.fonts.check("12px "+a)?(t.font=a,$("#glyph-box").css({fontFamily:a})):(M.toast({html:`不支持的字体：${a}`}),t.font="",$("#glyph-box").css({fontFamily:""}))}catch{M.toast({html:`不支持的字体：${a}`}),$("#glyph-box").css({fontFamily:""})}$("#glyph-box").text(t.hanzi),$("#showref-input").is(":checked")?$("#glyph-box").css({display:""}):$("#glyph-box").css({display:"none"}),function(a){var t=$("#em-box").width(),e=$("#em-box").height(),s=t*a.facew/100,h=e*a.faceh/100;$("#face-box").css({width:s+"px",height:h+"px",left:(t-s)/2+"px",top:(e-h)/2+"px"});var{axes:[o,i,l,r],bounds:[v,n,g,s],status:h}=function(a){let t=a.medw/100,e=a.medh/100,s=a.facew/100,h=a.faceh/100,o=[.5-s/2,.5+s/2,.5-h/2,.5+h/2],i=x[a.hanzi];const l=new Set("⿰⿱⿸⿹⿺");l.has(a.hanzi[0])&&(i=a.hanzi);if("string"!=typeof i)return{axes:[.5-e/2,.5+e/2,.5-t/2,.5+t/2],bounds:o,status:"unknownIDS"};let r=1,v=1,n=1,g=1;var u=p[[...i][1]],$=p[[...i][2]];if(void 0===u||void 0===$)return{axes:[.5-e/2,.5+e/2,.5-t/2,.5+t/2],bounds:o,status:"unknownComplexity"};{var d,m;a.overshoot&&(d=u[1]+$[1],m=u[2]+$[2],d=(d-3236)/933,d=2/(1+Math.exp(25*-d/12))-1,m=(m-3529)/1170,m=2/(1+Math.exp(25*-m/11))-1,t*=1+d/20,e*=1+m/20)}switch(i[0]){case"⿰":n=(a.weightmix*u[1]+(1-a.weightmix)*u[0])*(1-a.hweight),g=a.weightmix*$[1]+(1-a.weightmix)*$[0],o[1]=.5-t*(g/(n+g)-Math.sqrt(n)/(Math.sqrt(n)+Math.sqrt(g)));break;case"⿱":r=(a.weightmix*u[2]+(1-a.weightmix)*u[0])*(1-a.vweight),v=a.weightmix*$[2]+(1-a.weightmix)*$[0],o[3]=.5-e*(v/(r+v)-Math.sqrt(r)/(Math.sqrt(r)+Math.sqrt(v)));break;case"⿸":n=(a.weightmix*u[1]+(1-a.weightmix)*u[0])*(1-a.hweight),g=a.weightmix*$[1]+(1-a.weightmix)*$[0],r=(a.weightmix*u[2]+(1-a.weightmix)*u[0])*(1-a.vweight),v=a.weightmix*$[2]+(1-a.weightmix)*$[0],o[0]=.5-t*(g/(n+g)-Math.sqrt(n)/(Math.sqrt(n)+Math.sqrt(g))),o[2]=.5-e*(v/(r+v)-Math.sqrt(r)/(Math.sqrt(r)+Math.sqrt(v)));break;case"⿹":n=(a.weightmix*$[1]+(1-a.weightmix)*$[0])*(1-a.hweight),g=a.weightmix*u[1]+(1-a.weightmix)*u[0],r=(a.weightmix*u[2]+(1-a.weightmix)*u[0])*(1-a.vweight),v=a.weightmix*$[2]+(1-a.weightmix)*$[0],o[1]=.5-t*(g/(n+g)-Math.sqrt(n)/(Math.sqrt(n)+Math.sqrt(g))),o[2]=.5-e*(v/(r+v)-Math.sqrt(r)/(Math.sqrt(r)+Math.sqrt(v)));break;case"⿺":n=(a.weightmix*u[1]+(1-a.weightmix)*u[0])*(1-a.hweight),g=a.weightmix*$[1]+(1-a.weightmix)*$[0],r=(a.weightmix*$[2]+(1-a.weightmix)*$[0])*(1-a.vweight),v=a.weightmix*u[2]+(1-a.weightmix)*u[0],o[0]=.5-t*(g/(n+g)-Math.sqrt(n)/(Math.sqrt(n)+Math.sqrt(g))),o[3]=.5-e*(v/(r+v)-Math.sqrt(r)/(Math.sqrt(r)+Math.sqrt(v)));break;default:return{axes:[.5-e/2,.5+e/2,.5-t/2,.5+t/2],bounds:o,status:"unknownIDS"}}return{axes:[.5-e*v/(r+v),.5+e*r/(r+v),.5-t*g/(n+g),.5+t*n/(n+g)],bounds:o,status:"⿱"===i[0]?"horizontal":"⿰"===i[0]?"vertical":"done"}}(a);switch(h){case"unknownIDS":M.toast({html:"第二中心线理论不支持的构字，或拆字后部件过于生僻"}),$("#h-axes").addClass("gray-out"),$("#v-axes").addClass("gray-out"),$("#h1-val").addClass("gray-out"),$("#h2-val").addClass("gray-out"),$("#v1-val").addClass("gray-out"),$("#v2-val").addClass("gray-out"),$("#bounds").addClass("gray-out"),$("#hb-val").addClass("gray-out"),$("#vb-val").addClass("gray-out");break;case"unknownComplexity":M.toast({html:"部分部件视觉重量未知，无法计算"}),$("#h-axes").addClass("gray-out"),$("#v-axes").addClass("gray-out"),$("#h1-val").addClass("gray-out"),$("#h2-val").addClass("gray-out"),$("#v1-val").addClass("gray-out"),$("#v2-val").addClass("gray-out"),$("#bounds").addClass("gray-out"),$("#hb-val").addClass("gray-out"),$("#vb-val").addClass("gray-out");break;case"horizontal":$("#h-axes").removeClass("gray-out"),$("#v-axes").addClass("gray-out"),$("#h1-val").removeClass("gray-out"),$("#h2-val").removeClass("gray-out"),$("#v1-val").addClass("gray-out"),$("#v2-val").addClass("gray-out"),$("#bounds").removeClass("gray-out"),$("#hb-val").removeClass("gray-out"),$("#vb-val").addClass("gray-out");break;case"vertical":$("#h-axes").addClass("gray-out"),$("#v-axes").removeClass("gray-out"),$("#h1-val").addClass("gray-out"),$("#h2-val").addClass("gray-out"),$("#v1-val").removeClass("gray-out"),$("#v2-val").removeClass("gray-out"),$("#bounds").removeClass("gray-out"),$("#hb-val").addClass("gray-out"),$("#vb-val").removeClass("gray-out");break;case"done":$("#h-axes").removeClass("gray-out"),$("#v-axes").removeClass("gray-out"),$("#h1-val").removeClass("gray-out"),$("#h2-val").removeClass("gray-out"),$("#v1-val").removeClass("gray-out"),$("#v2-val").removeClass("gray-out"),$("#bounds").removeClass("gray-out"),$("#hb-val").removeClass("gray-out"),$("#vb-val").removeClass("gray-out")}$("#h-axes").css({height:`${(i-o)*e}px`,top:`${o*e}px`}),$("#v-axes").css({width:`${(r-l)*t}px`,left:`${l*t}px`}),$("#bounds").css({width:`${(n-v)*t}px`,height:`${(s-g)*e}px`,left:`${v*t}px`,top:`${g*t}px`});s=.5-g<s-.5?g:s,n=.5-v<n-.5?v:n;$("#h1-val").text(Math.round(a.upm*(1-o))-a.baseline),$("#h1-val").css({top:`${o*e}px`,transform:"translateY(-50%)"}),$("#h2-val").text(Math.round(a.upm*(1-i))-a.baseline),$("#h2-val").css({top:`${i*e}px`,transform:"translateY(-50%)"}),$("#hb-val").text(Math.round(a.upm*(1-s))-a.baseline),$("#hb-val").css({top:`${s*e}px`,transform:"translateY(-50%)"}),$("#v1-val").text(Math.round(l*a.upm)),$("#v1-val").css({left:`${l*t}px`,transform:"translateX(-50%)"}),$("#v2-val").text(Math.round(r*a.upm)),$("#v2-val").css({left:`${r*t}px`,transform:"translateX(-50%)"}),$("#vb-val").text(Math.round(n*a.upm)),$("#vb-val").css({left:`${n*e}px`,transform:"translateX(-50%)"})}(t),localStorage.setItem("secondMedialData",JSON.stringify(t))}let x={},p={};var a=$.getJSON("./data/ids_simple.json").then(a=>x=a),s=$.getJSON("./data/glyph_complexities.json").then(a=>p=a);$.when(a,s).then(()=>{var a=localStorage.getItem("secondMedialData");null!==a&&(t=JSON.parse(a),a=t,$("#hanzi-input").val(a.hanzi),$("#font-input").val(a.font),$("#upm-input").val(a.upm),$("#baseline-input").val(a.baseline),$("#facew-input").val(a.facew),$("#faceh-input").val(a.faceh),$("#medw-input").val(a.medw),$("#medh-input").val(a.medh),$("#overshoot-input").prop("checked",a.overshoot),$("#weightmix-input").val(a.weightmix),$("#hweight-input").val(a.hweight),$("#vweight-input").val(a.vweight)),e(),$("#loading").css({display:"none"})}),window.syncUI2Data=e}();